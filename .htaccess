Options -MultiViews
RewriteEngine On

# =========================================================
# 1) Maintenance mode (MUST be on top)
#   - create: maintenance.on  (empty file) in SAME folder as this .htaccess
#   - page:   maintenance.html
# =========================================================
RewriteCond %{DOCUMENT_ROOT}/maintenance.on -f [OR]
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI}maintenance.on -f

# Allow maintenance page + assets folders
RewriteCond %{REQUEST_URI} !^/maintenance\.html$ [NC]
RewriteCond %{REQUEST_URI} !^/assets/ [NC]
RewriteCond %{REQUEST_URI} !^/data/ [NC]
RewriteCond %{REQUEST_URI} !^/config/ [NC]
RewriteCond %{REQUEST_URI} !^/inc/ [NC]

RewriteRule ^.*$ /maintenance.html [R=302,L]


# =========================================================
# 2) Hide .php extension
# =========================================================

# Redirect /page.php -> /page
RewriteCond %{THE_REQUEST} \s/+(.*)\.php[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# Serve /page -> /page.php (only if file exists)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+?)/?$ $1.php [L]


# =========================================================
# 3) Custom 404 page
# =========================================================
ErrorDocument 404 /404.html
